<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intro to TBEP Tools • tbeptools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Intro to TBEP Tools">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tbeptools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">Intro to TBEP Tools</a>
    </li>
    <li>
      <a href="../articles/tidalcreeks.html">Tidal Creek Assessment</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tbep-tech/tbeptools">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intro_files/core-js-2.5.3/shim.min.js"></script><script src="intro_files/react-16.12.0/react.min.js"></script><script src="intro_files/react-16.12.0/react-dom.min.js"></script><script src="intro_files/reactwidget-1.0.0/react-tools.js"></script><script src="intro_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="intro_files/reactable-binding-0.1.0/reactable.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Intro to TBEP Tools</h1>
                        <h4 class="author">Marcus Beck, Ben Best</h4>
            
            <h4 class="date">2020-02-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tbep-tech/tbeptools/blob/master/vignettes/intro.Rmd"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>The environmental recovery of Tampa Bay is an exceptional success story for coastal water quality management. Nitrogen loads in the mid 1970s have been estimated at <span class="math inline">\(8.2 \times 10^6\)</span> kg yr<span class="math inline">\(^{-1}\)</span>, with approximately <span class="math inline">\(5.5 \times 10^6\)</span> kg yr<span class="math inline">\(^{-1}\)</span> entering the upper Bay alone <span class="citation">[1]</span>. Reduced water clarity associated with phytoplankton biomass contributed to a dramatic reduction in the areal coverage of seagrass <span class="citation">[3]</span> and development of hypoxic events, causing a decline in benthic faunal production <span class="citation">[4]</span>. Extensive efforts to reduce nutrient loads to the Bay occurred by the late 1970s, with the most notable being improvements in infrastructure for wastewater treatment in 1979. Improvements in water clarity and decreases in chlorophyll concentrations were observed Bay-wide in the 1980s, with conditions generally remaining constant to present day <span class="citation">[5]</span>.</p>
<p>Tracking changes in environmental condition from the past to present day would not have been possible without a long-term monitoring dataset. Data have been collected monthly by the Environmental Protection Commission of Hillsborough County since 1974 <span class="citation">[6,7]</span>. Samples are taken at forty-five stations using by water collection or monitoring sonde at bottom, mid- or surface depths, depending on parameter. The locations of monitoring stations are fixed and cover the entire Bay from the uppermost mesohaline sections to the lowermost euhaline portions that have direct interaction with the Gulf of Mexico. Up to 515 observations are available for different parameters at each station, e.g., nitrogen, chlorophyll-a, and secchi depth.</p>
<div class="figure" style="text-align: center">
<img src="tb_map.png" alt="Locations of long-term monitoring stations in Tampa Bay. The Bay is separated into four segments defined by chemical, physical, and geopolitical boundaries." width="80%"><p class="caption">
Locations of long-term monitoring stations in Tampa Bay. The Bay is separated into four segments defined by chemical, physical, and geopolitical boundaries.
</p>
</div>
</div>
<div id="package-goal" class="section level2">
<h2 class="hasAnchor">
<a href="#package-goal" class="anchor"></a>Package goal</h2>
<p>Data collected from the monitoring program are processed and maintained in a spreadsheet titled <code>RWMDataSpreadsheet_ThroughCurrentReportMonth.xlsx</code> at <a href="ftp://ftp.epchc.org/EPC_ERM_FTP/WQM_Reports/" class="uri">ftp://ftp.epchc.org/EPC_ERM_FTP/WQM_Reports/</a>. These data include observations at all stations and for all parameters throughout the period of record. To date, there have been no systematic tools for importing, analyzing, and reporting information from these data. The <strong>tbeptools</strong> package provides was developed to address this need.</p>
<p>Functions in tbeptools fall in three categories depending on mode of use. Each function is named using a prefix for the mode of use, followed by what the function does. The prefixes are:</p>
<ul>
<li><p><code>read</code>: Import current data from the main ftp site.</p></li>
<li><p><code>anlz</code>: Analyze or summarize the imported data.</p></li>
<li><p><code>show</code>: Create a plot of the analyzed data.</p></li>
</ul>
<p>The following shows all functions provided in tbeptools, organized by prefix.</p>
<div id="read" class="section level4">
<h4 class="hasAnchor">
<a href="#read" class="anchor"></a>Read</h4>
<ul>
<li><p><code><a href="../reference/read_chkdate.html">read_chkdate()</a></code>: Compare date of local xlsx file with the same file on the server</p></li>
<li><p><code><a href="../reference/read_dlcurrent.html">read_dlcurrent()</a></code>: Download latest water quality file from epchc.org</p></li>
<li><p><code><a href="../reference/read_formwq.html">read_formwq()</a></code>: Format water quality data</p></li>
<li><p><code><a href="../reference/read_importwq.html">read_importwq()</a></code>: Load local water quality file</p></li>
</ul>
</div>
<div id="analyze" class="section level4">
<h4 class="hasAnchor">
<a href="#analyze" class="anchor"></a>Analyze</h4>
<ul>
<li><p><code><a href="../reference/anlz_attain.html">anlz_attain()</a></code>: Get attainment categories</p></li>
<li><p><code><a href="../reference/anlz_attainsite.html">anlz_attainsite()</a></code>: Get site attainments</p></li>
<li><p><code><a href="../reference/anlz_avedat.html">anlz_avedat()</a></code>: Estimate annual means</p></li>
<li><p><code><a href="../reference/anlz_avedatsite.html">anlz_avedatsite()</a></code>: Estimate annual means by site</p></li>
<li><p><code><a href="../reference/anlz_refs.html">anlz_refs()</a></code>: Convert references csv to bib entries</p></li>
<li><p><code><a href="../reference/anlz_tdlcrk.html">anlz_tdlcrk()</a></code>: Estimate tidal creek report card scores</p></li>
<li><p><code><a href="../reference/anlz_yrattain.html">anlz_yrattain()</a></code>: Get attainment categories for a selected year</p></li>
</ul>
</div>
<div id="show" class="section level4">
<h4 class="hasAnchor">
<a href="#show" class="anchor"></a>Show</h4>
<ul>
<li><p><code><a href="../reference/show_boxplot.html">show_boxplot()</a></code>: Plot monthly chlorophyll or light attenuation values for a bay segment</p></li>
<li><p><code><a href="../reference/show_matrix.html">show_matrix()</a></code>: Create a colorized table for indicator reporting</p></li>
<li><p><code><a href="../reference/show_reactable.html">show_reactable()</a></code>: Create a reactable table for reporting matrices, used internally only</p></li>
<li><p><code><a href="../reference/show_segmatrix.html">show_segmatrix()</a></code>: Create a colorized table for water quality outcomes and exceedances by segment</p></li>
<li><p><code><a href="../reference/show_sitemap.html">show_sitemap()</a></code>: Plot a map of water quality stations for a selected year, with targets</p></li>
<li><p><code><a href="../reference/show_tdlcrk.html">show_tdlcrk()</a></code>: Make a map for tidal creek report card</p></li>
<li><p><code><a href="../reference/show_thrplot.html">show_thrplot()</a></code>: Plot annual water quality values, targets, and thresholds for a bay segment</p></li>
<li><p><code><a href="../reference/show_wqmatrix.html">show_wqmatrix()</a></code>: Create a colorized table for chlorophyll or light attenuation exceedances</p></li>
</ul>
<p>The functions can be easily found in RStudio after loading the package and typing the prefix at the command line. An autofill dialog box will pop up showing all functions that apply for the prefix. This eliminates the need for searching for individual functions if all you know is the category of function you need (e.g., <code>read</code>, <code>anlz</code>, or <code>show</code>). For example:</p>
<div class="figure" style="text-align: center">
<img src="readauto.png" alt="Searching for functions in tbeptools by typing in the prefix." width="80%"><p class="caption">
Searching for functions in tbeptools by typing in the prefix.
</p>
</div>
</div>
</div>
<div id="installing-tbeptools" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-tbeptools" class="anchor"></a>Installing tbeptools</h2>
<p>Begin by installing the package from GitHub. The source code is available on the tbep-tech GitHub group web page: <a href="https://github.com/tbep-tech/tbeptools" class="uri">https://github.com/tbep-tech/tbeptools</a>.</p>
<p>First, install the devtools package, load devtools, then install and load tbeptools. Note that tbeptools only needs to be installed once, but it needs to be loaded every new R session (i.e., <code><a href="https://rdrr.io/r/base/library.html">library(devtools)</a></code>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'devtools'</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(devtools)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">install_github</span>(<span class="st">'tbeptools'</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tbeptools)</a></code></pre></div>
<p>After the package is loaded, you can view the help files for each function by typing a question mark followed by the function name, e.g., <code><a href="../reference/read_importwq.html">?read_importwq</a></code>, on the console. The help files provide a brief description of what each function does and the required arguments that are needed to run the function.</p>
<div class="figure" style="text-align: center">
<img src="helpfileex.png" alt="The help file for `read_importwq`." width="70%"><p class="caption">
The help file for <code>read_importwq</code>.
</p>
</div>
<p>In the above example, the <code><a href="../reference/read_importwq.html">read_importwq()</a></code> functions accepts six arguments. All but one argument have default values that change the behavior of the function. In most cases, the default values are appropriate. The only required argument is <code>xlsx</code> that specifies a path where a local excel file is located. The details of this function are described below.</p>
</div>
<div id="read-1" class="section level2">
<h2 class="hasAnchor">
<a href="#read-1" class="anchor"></a>Read</h2>
<p>There are 4 functions in tbeptools for reading or importing data from the main ftp website listed above:</p>
<ul>
<li><p><code><a href="../reference/read_chkdate.html">read_chkdate()</a></code>: Compare date of local xlsx file with the same file on the server</p></li>
<li><p><code><a href="../reference/read_dlcurrent.html">read_dlcurrent()</a></code>: Download latest water quality file from epchc.org</p></li>
<li><p><code><a href="../reference/read_formwq.html">read_formwq()</a></code>: Format water quality data</p></li>
<li><p><code><a href="../reference/read_importwq.html">read_importwq()</a></code>: Load local water quality file</p></li>
</ul>
<p>The main function is <code><a href="../reference/read_importwq.html">read_importwq()</a></code> - the remainder are all used within <code><a href="../reference/read_importwq.html">read_importwq()</a></code> to accomplish different tasks when importing the data. This function downloads the latest file if one is not already available at the location specified by the <code>xlsx</code> input argument.</p>
<p>First, create a character path for the location of the file. If one does not exist, specify a desired location and name for the downloaded file. Here, we want to put the file in the vignettes folder and name is 2018_Results_updated.xls. Note that this file path is relative to the root working directly for the current R session. You can view the working directory with <code><a href="https://rdrr.io/r/base/getwd.html">getwd()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">xlsx &lt;-<span class="st"> 'vignettes/2018_Results_updated.xls'</span></a></code></pre></div>
<p>Now we pass this <code>xlsx</code> object to the <code><a href="../reference/read_importwq.html">read_importwq()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">ecpdata &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_importwq.html">read_importwq</a></span>(xlsx)</a></code></pre></div>
<pre><code>#&gt; Error in read_importwq("empty") : file.exists(xlsx) is not TRUE</code></pre>
<p>We get an error message from the function indicating that the file is not found. This makes sense because the file doesn’t exist yet, so we need to tell the function to download the latest file. This is done by changing the <code>download_latest_file</code> argument to <code>TRUE</code> (the default is <code>FALSE</code>).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">ecpdata &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_importwq.html">read_importwq</a></span>(xlsx, <span class="dt">download_latest_epchc =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>#&gt; File vignettes/2018_Results_updated.xls does not exist, replacing with downloaded file...

#&gt; trying URL 'ftp://ftp.epchc.org/EPC_ERM_FTP/WQM_Reports/RWMDataSpreadsheet_ThroughCurrentReportMonth.xlsx'
 length 24562051 bytes (23.4 MB)</code></pre>
<p>Now we get the same message, but with an indication that file on the server is being downloaded. We’ll have the data downloaded and saved to the <code>epcdata</code> object after it finishes downloading.</p>
<p>If we try to run the function again after downloading the data from the server, we get the following message. This check is done to make sure that the data are not unnecessarily downloaded if the current matches the file on the server.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">ecpdata &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_importwq.html">read_importwq</a></span>(xlsx, <span class="dt">download_latest_epchc =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>#&gt; File is current...</code></pre>
<p>Every time that tbeptools is used to work with the monitoring data, <code><a href="../reference/read_importwq.html">read_importwq()</a></code> should be used to import the data. You will always receive the message <code>File is current...</code> if your local file matches the one on the server. However, new data are regularly collected and posted on the server. If <code>download_latest_file = TRUE</code> and your local file is out of date, you will receive the following message:</p>
<pre><code>#&gt; Replacing local file with current...</code></pre>
<p>The additional arguments in <code><a href="../reference/read_importwq.html">read_importwq()</a></code> can be used to troubleshoot the download if the connection to the server is unsuccessful. Specifically, <code>connecttimeout</code> specifies the maximum number of seconds to wait before a timeout error occurs. You can try increasing this number from the default of 10 seconds if the connection is unsuccessful, although the connection typically takes only a few seconds if successful. The <code>tryurl</code> argument indicates if the data are requested again from the server if the first attempt is unsuccessful. This is repeated if <code>tryurl = TRUE</code> until a successful connection is made.</p>
<p>The final argument <code>na</code> indicates which fields in the downloaded spreadsheet are treated as blank values and assigned to <code>NA</code>. Any number of strings can be added to this function to replace fields with <code>NA</code> values.</p>
<p>After the data are successfully imported, you can view them from the assigned object:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">epcdata</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; # A tibble: 25,669 x 14</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt;    bay_segment epchc_station SampleTime             yr    mo Latitude Longitude</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt;    &lt;chr&gt;               &lt;dbl&gt; &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt;  1 HB                      6 2019-12-09 09:24:00  2019    12     27.9     -82.5</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt;  2 HB                      7 2019-12-09 09:33:00  2019    12     27.9     -82.5</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt;  3 HB                      8 2019-12-09 11:42:00  2019    12     27.9     -82.4</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt;  4 MTB                     9 2019-12-09 10:58:00  2019    12     27.8     -82.4</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt;  5 MTB                    11 2019-12-09 09:49:00  2019    12     27.8     -82.5</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt;  6 MTB                    13 2019-12-09 10:00:00  2019    12     27.8     -82.5</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt;  7 MTB                    14 2019-12-09 10:37:00  2019    12     27.8     -82.5</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt;  8 MTB                    16 2019-12-17 10:13:00  2019    12     27.7     -82.5</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt;  9 MTB                    19 2019-12-17 10:31:00  2019    12     27.7     -82.6</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt; 10 LTB                    23 2019-12-17 14:44:00  2019    12     27.7     -82.6</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">#&gt; # ... with 25,659 more rows, and 7 more variables: Total_Depth_m &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">#&gt; #   Sample_Depth_m &lt;dbl&gt;, sd_m &lt;dbl&gt;, chla &lt;dbl&gt;, Sal_Top_ppth &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">#&gt; #   Sal_Mid_ppth &lt;dbl&gt;, Sal_Bottom_ppth &lt;dbl&gt;</span></a></code></pre></div>
<p>These data include the bay segment name, station number, sample time, year, month, latitude, longitude, station depth, sample depth, secchi depth, and chlorophyll. Note that the monitoring data include additional parameters. Chlorophyll and secchi depth are currently the only parameters returned by <code><a href="../reference/read_importwq.html">read_importwq()</a></code> given the reporting indicators used below.</p>
</div>
<div id="analyze-1" class="section level2 tabset">
<h2 class="hasAnchor">
<a href="#analyze-1" class="anchor"></a>Analyze</h2>
<p>The analyze functions are used primarily to summarize the data returned by <code><a href="../reference/read_importwq.html">read_importwq()</a></code>.</p>
<ul>
<li><p><code><a href="../reference/anlz_attain.html">anlz_attain()</a></code>: Get attainment categories</p></li>
<li><p><code><a href="../reference/anlz_attainsite.html">anlz_attainsite()</a></code>: Get site attainments</p></li>
<li><p><code><a href="../reference/anlz_avedat.html">anlz_avedat()</a></code>: Estimate annual means</p></li>
<li><p><code><a href="../reference/anlz_avedatsite.html">anlz_avedatsite()</a></code>: Estimate annual means by site</p></li>
<li><p><code><a href="../reference/anlz_refs.html">anlz_refs()</a></code>: Convert references csv to bib entries</p></li>
<li><p><code><a href="../reference/anlz_tdlcrk.html">anlz_tdlcrk()</a></code>: Estimate tidal creek report card scores</p></li>
<li><p><code><a href="../reference/anlz_yrattain.html">anlz_yrattain()</a></code>: Get attainment categories for a selected year</p></li>
</ul>
<p>The functions <code><a href="../reference/anlz_avedat.html">anlz_avedat()</a></code> and <code><a href="../reference/anlz_avedatsite.html">anlz_avedatsite()</a></code> summarize the station data by bay segments or by sites, respectively. Both functions return annual means for chlorophyll and light attenuation (based on Secchi depth measurements) and monthly means by year for chlorophyll and light attenuation. These summaries are then used to determine if bay segment targets for water quality are met using the <code><a href="../reference/anlz_attain.html">anlz_attain()</a></code> and <code><a href="../reference/anlz_attainsite.html">anlz_attainsite()</a></code> function.</p>
<p>Here we use <code><a href="../reference/anlz_avedat.html">anlz_avedat()</a></code> to summarize the data by bay segment to estimate annual and monthly means for chlorophyll and light attenuation. The output is a two-element list for the annual (<code>ann</code>) and monthly (<code>mos</code>) means by segment.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">avedat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/anlz_avedat.html">anlz_avedat</a></span>(epcdata)</a>
<a class="sourceLine" id="cb11-2" title="2">avedat</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#&gt; $ann</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt; # A tibble: 560 x 4</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt;    bay_segment    yr var         val</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt;  1 HB           1974 mean_chla  22.4</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt;  2 HB           1975 mean_chla  27.9</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">#&gt;  3 HB           1976 mean_chla  29.5</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt;  4 HB           1977 mean_chla  32.5</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt;  5 HB           1978 mean_chla  22.0</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">#&gt;  6 HB           1979 mean_chla  29.7</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">#&gt;  7 HB           1980 mean_chla  22.6</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">#&gt;  8 HB           1981 mean_chla  31.1</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">#&gt;  9 HB           1982 mean_chla  36.1</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">#&gt; 10 HB           1983 mean_chla  25.9</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co">#&gt; # ... with 550 more rows</span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="co">#&gt; $mos</span></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="co">#&gt; # A tibble: 4,357 x 5</span></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="co">#&gt;       yr    mo bay_segment var         val</span></a>
<a class="sourceLine" id="cb11-22" title="22"><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="co">#&gt;  1  1974     1 HB          mean_chla 36.2 </span></a>
<a class="sourceLine" id="cb11-24" title="24"><span class="co">#&gt;  2  1974     1 LTB         mean_chla  1.75</span></a>
<a class="sourceLine" id="cb11-25" title="25"><span class="co">#&gt;  3  1974     1 OTB         mean_chla  4.4 </span></a>
<a class="sourceLine" id="cb11-26" title="26"><span class="co">#&gt;  4  1974     2 HB          mean_chla 42.4 </span></a>
<a class="sourceLine" id="cb11-27" title="27"><span class="co">#&gt;  5  1974     2 LTB         mean_chla  5.5 </span></a>
<a class="sourceLine" id="cb11-28" title="28"><span class="co">#&gt;  6  1974     2 OTB         mean_chla  4.07</span></a>
<a class="sourceLine" id="cb11-29" title="29"><span class="co">#&gt;  7  1974     3 HB          mean_chla 14.9 </span></a>
<a class="sourceLine" id="cb11-30" title="30"><span class="co">#&gt;  8  1974     3 LTB         mean_chla  5.88</span></a>
<a class="sourceLine" id="cb11-31" title="31"><span class="co">#&gt;  9  1974     4 HB          mean_chla 14.6 </span></a>
<a class="sourceLine" id="cb11-32" title="32"><span class="co">#&gt; 10  1974     4 LTB         mean_chla  1.75</span></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="co">#&gt; # ... with 4,347 more rows</span></a></code></pre></div>
<p>This output can then be further analyzed with <code><a href="../reference/anlz_attain.html">anlz_attain()</a></code> to determine if the bay segment outcomes are met in each year. The results are used by the plotting functions described below. In short, the <code>chl_la</code> column indicates the categorical outcome for chlorophyll and light attenuation for each segment. The outcomes are integer values from zero to three. The relative exceedances of water quality thresholds for each segment, both in duration and magnitude, are indicated by higher integer values.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="../reference/anlz_attain.html">anlz_attain</a></span>(avedat)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt; # A tibble: 184 x 4</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">#&gt;    bay_segment    yr chl_la outcome</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">#&gt;  1 HB           1974 3_0    yellow </span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">#&gt;  2 HB           1975 3_2    red    </span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">#&gt;  3 HB           1976 3_2    red    </span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">#&gt;  4 HB           1977 3_2    red    </span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">#&gt;  5 HB           1978 3_3    red    </span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co">#&gt;  6 HB           1979 3_3    red    </span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">#&gt;  7 HB           1980 3_3    red    </span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">#&gt;  8 HB           1981 3_3    red    </span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">#&gt;  9 HB           1982 3_3    red    </span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">#&gt; 10 HB           1983 3_0    yellow </span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">#&gt; # ... with 174 more rows</span></a></code></pre></div>
<p>Similar information can be obtained for individual sites using <code><a href="../reference/anlz_avedatsite.html">anlz_avedatsite()</a></code> and <code><a href="../reference/anlz_attainsite.html">anlz_attainsite()</a></code>. The main difference is that a yes/no column <code>trgmet</code>is added that indicates only if the target was above or below the segment threshold for each site.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="../reference/anlz_avedatsite.html">anlz_avedatsite</a></span>(epcdata) <span class="op">%&gt;%</span><span class="st"> </span>anlz_attainsite</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">#&gt; # A tibble: 2,070 x 9</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">#&gt;    bay_segment epchc_station    yr var     val target smallex thresh trgtmet</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#&gt;    &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">#&gt;  1 HB                      6  1974 chla   25.6   13.2    14.1     15 no     </span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">#&gt;  2 HB                      6  1975 chla   24.8   13.2    14.1     15 no     </span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">#&gt;  3 HB                      6  1976 chla   33.0   13.2    14.1     15 no     </span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">#&gt;  4 HB                      6  1977 chla   43.9   13.2    14.1     15 no     </span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">#&gt;  5 HB                      6  1978 chla   28.5   13.2    14.1     15 no     </span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co">#&gt;  6 HB                      6  1979 chla   27.2   13.2    14.1     15 no     </span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">#&gt;  7 HB                      6  1980 chla   23.8   13.2    14.1     15 no     </span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">#&gt;  8 HB                      6  1981 chla   41.0   13.2    14.1     15 no     </span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co">#&gt;  9 HB                      6  1982 chla   25.4   13.2    14.1     15 no     </span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co">#&gt; 10 HB                      6  1983 chla   25.9   13.2    14.1     15 no     </span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="co">#&gt; # ... with 2,060 more rows</span></a></code></pre></div>
<p>The condition of tidal creeks can be evaluated using the <code>anlz_tldcrk()</code> function. View the <a href="https://tbep-tech.github.io/tbeptools/articles/tidalcreeks.html">Tidal Creek Assessment</a> vignette for additional information.</p>
</div>
<div id="show-1" class="section level2">
<h2 class="hasAnchor">
<a href="#show-1" class="anchor"></a>Show</h2>
<p>The plotting functions are used to view long-term trends for each bay segment and annual results for the overall water quality assessment:</p>
<ul>
<li><p><code><a href="../reference/show_boxplot.html">show_boxplot()</a></code>: Plot monthly chlorophyll or light attenuation values for a bay segment</p></li>
<li><p><code><a href="../reference/show_matrix.html">show_matrix()</a></code>: Create a colorized table for indicator reporting</p></li>
<li><p><code><a href="../reference/show_reactable.html">show_reactable()</a></code>: Create a reactable table for reporting matrices, used internally only</p></li>
<li><p><code><a href="../reference/show_segmatrix.html">show_segmatrix()</a></code>: Create a colorized table for water quality outcomes and exceedances by segment</p></li>
<li><p><code><a href="../reference/show_sitemap.html">show_sitemap()</a></code>: Plot a map of water quality stations for a selected year, with targets</p></li>
<li><p><code><a href="../reference/show_tdlcrk.html">show_tdlcrk()</a></code>: Make a map for tidal creek report card</p></li>
<li><p><code><a href="../reference/show_thrplot.html">show_thrplot()</a></code>: Plot annual water quality values, targets, and thresholds for a bay segment</p></li>
<li><p><code><a href="../reference/show_wqmatrix.html">show_wqmatrix()</a></code>: Create a colorized table for chlorophyll or light attenuation exceedances</p></li>
</ul>
<p>External package libraries in R can be used to plot the time series data. Here’s an example using the popular <a href="https://ggplot2.tidyverse.org/">ggplot2</a> package. Some data wrangling with the <a href="https://dplyr.tidyverse.org/">dplyr</a> is done first to filter the data we want to plot.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">toplo &lt;-<span class="st"> </span>epcdata <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(epchc_station <span class="op">==</span><span class="st"> '52'</span>)</a>
<a class="sourceLine" id="cb14-3" title="3"></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="kw">ggplot</span>(toplo, <span class="kw">aes</span>(<span class="dt">x =</span> SampleTime, <span class="dt">y =</span> chla)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="st">  </span><span class="kw">scale_y_log10</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="st">  </span><span class="kw">labs</span>(</a>
<a class="sourceLine" id="cb14-9" title="9">    <span class="dt">y =</span> <span class="st">'Chlorophyll-a concentration (ug/L)'</span>, </a>
<a class="sourceLine" id="cb14-10" title="10">    <span class="dt">x =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb14-11" title="11">    <span class="dt">title =</span> <span class="st">'Chlorophyll trends'</span>,</a>
<a class="sourceLine" id="cb14-12" title="12">    <span class="dt">subtitle =</span> <span class="st">'Hillsborough Bay station 52, all dates'</span></a>
<a class="sourceLine" id="cb14-13" title="13">    ) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-12-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/show_thrplot.html">show_thrplot()</a></code> function provides a more descriptive assessment of annual trends for a chosen bay segment relative to defined targets or thresholds. In this plot we show the annual averages across stations Old Tampa bay (<code>bay_segment = "OTB"</code>) for chlorophyll (<code>thr = "chla"</code>). The red line shows annual trends and the horizontal blue lines indicate the thresholds and targets for chlorophyll-a that are specific to Old Tampa Bay. The dashed and dotted blue lines indicate +1 and +2 standard errors for the management target shown by the filled line. The target and standard errors are considered when identifying the annual segment outcome for chlorophyll.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="../reference/show_thrplot.html">show_thrplot</a></span>(epcdata, <span class="dt">bay_segment =</span> <span class="st">"OTB"</span>, <span class="dt">thr =</span> <span class="st">"chla"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-13-1.png" width="768" style="display: block; margin: auto;"></p>
<p>We can show the same plot but for light attenuation by changing the <code>thr = "chla"</code> to <code>thr = "la"</code>. Note the change in the horizontal reference lines for the light attenuation target.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw"><a href="../reference/show_thrplot.html">show_thrplot</a></span>(epcdata, <span class="dt">bay_segment =</span> <span class="st">"OTB"</span>, <span class="dt">thr =</span> <span class="st">"la"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-14-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The year range to plot can also be specified using the <code>yrrng</code> argument, where the default is <code>yrrng = c(1975, 2018)</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw"><a href="../reference/show_thrplot.html">show_thrplot</a></span>(epcdata, <span class="dt">bay_segment =</span> <span class="st">"OTB"</span>, <span class="dt">thr =</span> <span class="st">"la"</span>, <span class="dt">yrrng =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2000</span>, <span class="dv">2018</span>))</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-15-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/show_thrplot.html">show_thrplot()</a></code> function uses results from the <code><a href="../reference/anlz_avedat.html">anlz_avedat()</a></code> function. For example, you can retrieve the values from the above plot as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">epcdata <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span>anlz_avedat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">  </span>.[[<span class="st">'ann'</span>]] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(bay_segment <span class="op">==</span><span class="st"> 'OTB'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(var <span class="op">==</span><span class="st"> 'mean_la'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(yr <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2000</span> <span class="op">&amp;</span><span class="st"> </span>yr <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">#&gt; # A tibble: 19 x 4</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">#&gt;    bay_segment    yr var       val</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co">#&gt;  1 OTB          2000 mean_la 0.733</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co">#&gt;  2 OTB          2001 mean_la 0.951</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="co">#&gt;  3 OTB          2002 mean_la 0.927</span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="co">#&gt;  4 OTB          2003 mean_la 1.04 </span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co">#&gt;  5 OTB          2004 mean_la 0.878</span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="co">#&gt;  6 OTB          2005 mean_la 0.769</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="co">#&gt;  7 OTB          2006 mean_la 0.620</span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="co">#&gt;  8 OTB          2007 mean_la 0.677</span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co">#&gt;  9 OTB          2008 mean_la 0.696</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co">#&gt; 10 OTB          2009 mean_la 0.808</span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co">#&gt; 11 OTB          2010 mean_la 0.842</span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="co">#&gt; 12 OTB          2011 mean_la 0.912</span></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="co">#&gt; 13 OTB          2012 mean_la 0.687</span></a>
<a class="sourceLine" id="cb18-23" title="23"><span class="co">#&gt; 14 OTB          2013 mean_la 0.567</span></a>
<a class="sourceLine" id="cb18-24" title="24"><span class="co">#&gt; 15 OTB          2014 mean_la 0.606</span></a>
<a class="sourceLine" id="cb18-25" title="25"><span class="co">#&gt; 16 OTB          2015 mean_la 0.560</span></a>
<a class="sourceLine" id="cb18-26" title="26"><span class="co">#&gt; 17 OTB          2016 mean_la 0.575</span></a>
<a class="sourceLine" id="cb18-27" title="27"><span class="co">#&gt; 18 OTB          2017 mean_la 0.682</span></a>
<a class="sourceLine" id="cb18-28" title="28"><span class="co">#&gt; 19 OTB          2018 mean_la 0.678</span></a></code></pre></div>
<p>Similarly, the <code><a href="../reference/show_boxplot.html">show_boxplot()</a></code> function provides an assessment of seasonal changes in chlorophyll or light attenuation values by bay segment. The most recent year is highlighted in red by default. This allows a simple evaluation of how the most recent year compared to historical averages. The large exceedance value is shown in blue text and as the dotted line. This corresponds to a “large” magnitude change of +2 standard errors above the bay segment threshold and is the same dotted line shown in <code><a href="../reference/show_thrplot.html">show_thrplot()</a></code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw"><a href="../reference/show_boxplot.html">show_boxplot</a></span>(epcdata, <span class="dt">param =</span> <span class="st">'chla'</span>, <span class="dt">bay_segment =</span> <span class="st">"OTB"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-17-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw"><a href="../reference/show_boxplot.html">show_boxplot</a></span>(epcdata, <span class="dt">param =</span> <span class="st">'la'</span>, <span class="dt">bay_segment =</span> <span class="st">"HB"</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-17-2.png" width="768" style="display: block; margin: auto;"></p>
<p>A different subset of years and selected year of interest can also be viewed by changing the <code>yrrng</code> and <code>yrsel</code> arguments. Here we show 1980 compared to monthly averages for the last ten years.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="../reference/show_boxplot.html">show_boxplot</a></span>(epcdata, <span class="dt">param =</span> <span class="st">'chla'</span>, <span class="dt">bay_segment =</span> <span class="st">"OTB"</span>, <span class="dt">yrrng =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2008</span>, <span class="dv">2018</span>), <span class="dt">yrsel =</span> <span class="dv">1980</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-18-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/show_thrplot.html">show_thrplot()</a></code> function is useful to understand annual variation in chlorophyll and light attenuation relative to management targets for each bay segment. The information from these plots can provide an understanding of how the annual reporting outcomes are determined. As noted above, an outcome integer from zero to three is assigned to each bay segment for each annual estimate of chlorophyll and light attenuation. These outcomes are based on both the exceedance of the annual estimate above the threshold or target (blue lines in <code><a href="../reference/show_thrplot.html">show_thrplot()</a></code>) and duration of the exceedance for the years prior. The following graphic describes this logic <span class="citation">[8]</span>.</p>
<div class="figure" style="text-align: center">
<img src="outints.PNG" alt="Outcomes for annual estimates of water quality are assigned an integer value from zero to three depending on both magnitude and duration of the exceedence." width="80%"><p class="caption">
Outcomes for annual estimates of water quality are assigned an integer value from zero to three depending on both magnitude and duration of the exceedence.
</p>
</div>
<p>These outcomes are assigned for both chlorophyll and light attenuation. The duration criteria are determined based on whether the exceedance was observed for years prior to the current year. The exceedance criteria for chlorophyll and light-attenuation are specific to each segment. The tbeptools package contains a <code>targets</code> data file that is a reference for determining annual outcomes. This file is loaded automatically with the package and can be viewed from the command line.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">targets</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co">#&gt;   bay_segment             name chla_target chla_smallex chla_thresh la_target</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co">#&gt; 1         OTB    Old Tampa Bay         8.5          8.9         9.3      0.83</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co">#&gt; 2          HB Hillsborough Bay        13.2         14.1        15.0      1.58</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co">#&gt; 3         MTB Middle Tampa Bay         7.4          7.9         8.5      0.83</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co">#&gt; 4         LTB  Lower Tampa Bay         4.6          4.8         5.1      0.63</span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="co">#&gt;   la_smallex la_thresh</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="co">#&gt; 1       0.86      0.88</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co">#&gt; 2       1.63      1.67</span></a>
<a class="sourceLine" id="cb22-10" title="10"><span class="co">#&gt; 3       0.87      0.91</span></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="co">#&gt; 4       0.66      0.68</span></a></code></pre></div>
<p>The final plotting function is <code><a href="../reference/show_matrix.html">show_matrix()</a></code>, which creates an annual reporting matrix that reflects the combined outcomes for chlorophyll and light attenuation. Tracking the attainment of bay segment specific targets for these indicators provides the framework from which bay management actions are developed and initiated. For each year and segment, a color-coded management action is assigned:</p>
<p><span style="color:#33FF3B; text-shadow: 0 0 3px #333;"><strong>Stay the Course</strong></span>: Continue planned projects. Report data via annual progress reports and Baywide Environmental Monitoring Report.</p>
<p><span style="color:#F9FF33; text-shadow: 0 0 3px #333;"><strong>Caution</strong></span>: Review monitoring data and nitrogen loading estimates. Begin/continue TAC and Management Board development of specific management recommendations.</p>
<p><span style="color:#FF3333; text-shadow: 0 0 3px #333;"><strong>On Alert</strong></span>: Finalize development and implement appropriate management actions to get back on track.</p>
<p>The management category or action is based on the combination of outcomes for chlorophyll and light attenuation <span class="citation">[8]</span>.</p>
<div class="figure" style="text-align: center">
<img src="matrixcats.PNG" alt="Management action categories assigned to each bay segment and year based on chlorophyll and light attenuation outcomes." width="80%"><p class="caption">
Management action categories assigned to each bay segment and year based on chlorophyll and light attenuation outcomes.
</p>
</div>
<p>The results can be viewed with <code><a href="../reference/show_matrix.html">show_matrix()</a></code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw"><a href="../reference/show_matrix.html">show_matrix</a></span>(epcdata)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-22-1.png" width="288" style="display: block; margin: auto;"></p>
<p>The matrix is also a <code>ggplot</code> object and its layout can be changed using <code>ggplot</code> elements. Note the use of <code>txtsz = NULL</code> to remove the color labels.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw"><a href="../reference/show_matrix.html">show_matrix</a></span>(epcdata, <span class="dt">txtsz =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1975</span><span class="op">:</span><span class="dv">2018</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">7</span>))</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-23-1.png" width="768" style="display: block; margin: auto;"></p>
<p>If preferred, the matrix can also be returned in an HTML table that can be sorted and scrolled.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw"><a href="../reference/show_matrix.html">show_matrix</a></span>(epcdata, <span class="dt">asreact =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div id="htmlwidget-171827b5c41745bc3e2e" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-171827b5c41745bc3e2e">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"yr":[1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018],"OTB":["red","red","red","red","red","red","red","red","red","red","red","red","yellow","green","red","yellow","green","green","yellow","yellow","red","yellow","green","red","yellow","green","yellow","yellow","red","red","green","green","green","yellow","yellow","green","red","green","green","green","yellow","yellow","yellow","yellow"],"HB":["red","red","red","red","red","red","red","red","yellow","green","red","yellow","yellow","green","yellow","green","yellow","green","green","yellow","yellow","green","green","yellow","green","green","green","green","green","green","green","green","green","green","yellow","green","green","green","green","green","green","green","green","green"],"MTB":["red","red","red","red","red","red","red","red","red","red","red","yellow","yellow","green","yellow","yellow","green","green","green","yellow","yellow","green","yellow","red","green","green","yellow","green","green","green","green","green","green","green","green","green","yellow","green","green","green","yellow","green","green","green"],"LTB":["yellow","red","red","yellow","red","red","red","red","red","yellow","yellow","green","green","green","yellow","green","yellow","yellow","yellow","red","yellow","green","green","red","yellow","yellow","yellow","green","green","yellow","yellow","green","green","yellow","green","green","green","green","green","green","green","green","green","green"]},"columns":[{"accessor":"yr","name":"Year","type":"numeric","style":[{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null}]},{"accessor":"OTB","name":"OTB","type":"character","style":[{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#FF3333"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#F9FF33"}]},{"accessor":"HB","name":"HB","type":"character","style":[{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"}]},{"accessor":"MTB","name":"MTB","type":"character","style":[{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"}]},{"accessor":"LTB","name":"LTB","type":"character","style":[{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"}]}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"a791b06e896b02f335b43047cdda12ab"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script><p>Use a sufficiently large number to view the entire matrix.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw"><a href="../reference/show_matrix.html">show_matrix</a></span>(epcdata, <span class="dt">asreact =</span> <span class="ot">TRUE</span>, <span class="dt">nrows =</span> <span class="dv">200</span>)</a></code></pre></div>
<div id="htmlwidget-ad0f9e739e8baf12257d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ad0f9e739e8baf12257d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"yr":[1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018],"OTB":["red","red","red","red","red","red","red","red","red","red","red","red","yellow","green","red","yellow","green","green","yellow","yellow","red","yellow","green","red","yellow","green","yellow","yellow","red","red","green","green","green","yellow","yellow","green","red","green","green","green","yellow","yellow","yellow","yellow"],"HB":["red","red","red","red","red","red","red","red","yellow","green","red","yellow","yellow","green","yellow","green","yellow","green","green","yellow","yellow","green","green","yellow","green","green","green","green","green","green","green","green","green","green","yellow","green","green","green","green","green","green","green","green","green"],"MTB":["red","red","red","red","red","red","red","red","red","red","red","yellow","yellow","green","yellow","yellow","green","green","green","yellow","yellow","green","yellow","red","green","green","yellow","green","green","green","green","green","green","green","green","green","yellow","green","green","green","yellow","green","green","green"],"LTB":["yellow","red","red","yellow","red","red","red","red","red","yellow","yellow","green","green","green","yellow","green","yellow","yellow","yellow","red","yellow","green","green","red","yellow","yellow","yellow","green","green","yellow","yellow","green","green","yellow","green","green","green","green","green","green","green","green","green","green"]},"columns":[{"accessor":"yr","name":"Year","type":"numeric","style":[{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null},{"background":null}]},{"accessor":"OTB","name":"OTB","type":"character","style":[{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#FF3333"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#F9FF33"}]},{"accessor":"HB","name":"HB","type":"character","style":[{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"}]},{"accessor":"MTB","name":"MTB","type":"character","style":[{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"}]},{"accessor":"LTB","name":"LTB","type":"character","style":[{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#FF3333"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#F9FF33"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"},{"background":"#33FF3B"}]}],"defaultPageSize":200,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"a791b06e896b02f335b43047cdda12ab"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script><p>Results can also be obtained for a selected year. Outcomes can be returned in tabular format with <code><a href="../reference/anlz_yrattain.html">anlz_yrattain()</a></code>. This table also shows segment averages for chlorophyll and light attenuation, including the associated targets.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw"><a href="../reference/anlz_yrattain.html">anlz_yrattain</a></span>(epcdata, <span class="dt">yrsel =</span> <span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="co">#&gt; # A tibble: 4 x 6</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="co">#&gt;   bay_segment chla_val chla_target la_val la_target outcome</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="co">#&gt;   &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="co">#&gt; 1 OTB             9.22         8.5  0.678      0.83 yellow </span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="co">#&gt; 2 HB             13.9         13.2  1.09       1.58 green  </span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="co">#&gt; 3 MTB             7.05         7.4  0.570      0.83 green  </span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="co">#&gt; 4 LTB             4.65         4.6  0.593      0.63 green</span></a></code></pre></div>
<p>A map showing if individual sites achieved chlorophyll targets can be obtained with <code><a href="../reference/show_sitemap.html">show_sitemap()</a></code>. The station averages for chlorophyll for the selected year are shown next to each point. Stations in red failed to meet the segment target.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw"><a href="../reference/show_sitemap.html">show_sitemap</a></span>(epcdata, <span class="dt">yrsel =</span> <span class="dv">2018</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-27-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Bay segment exceedances can also be viewed in a matrix using <code><a href="../reference/show_wqmatrix.html">show_wqmatrix()</a></code>. The thresholds for these values correspond to the Florida DEP criteria (or a large exceedance defined as +2 standard errors above the segment target).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw"><a href="../reference/show_wqmatrix.html">show_wqmatrix</a></span>(epcdata)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-28-1.png" width="288" style="display: block; margin: auto;"></p>
<p>By default, the <code><a href="../reference/show_wqmatrix.html">show_wqmatrix()</a></code> function returns chlorophyll exceedances by segment. Light attenuation exceedances can be viewed by changing the <code>param</code> argument.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw"><a href="../reference/show_wqmatrix.html">show_wqmatrix</a></span>(epcdata, <span class="dt">param =</span> <span class="st">'la'</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-29-1.png" width="288" style="display: block; margin: auto;"></p>
<p>Finally, the results from <code><a href="../reference/show_matrix.html">show_matrix()</a></code> and <code><a href="../reference/show_wqmatrix.html">show_wqmatrix()</a></code> can be combined for an individual segment using the <code><a href="../reference/show_segmatrix.html">show_segmatrix()</a></code> function. This is useful to understand which water quality parameter is driving the management outcome for a given year. The plot shows the light attenuation and chlorophyll outcomes from <code><a href="../reference/show_wqmatrix.html">show_wqmatrix()</a></code> next to the segment management outcomes from <code><a href="../reference/show_matrix.html">show_matrix()</a></code>. Only one segment can be plotted for each function call.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw"><a href="../reference/show_segmatrix.html">show_segmatrix</a></span>(epcdata, <span class="dt">bay_segment =</span> <span class="st">'OTB'</span>)</a></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-30-1.png" width="240" style="display: block; margin: auto;"></p>
<p>From these plots, we can quickly view a summary of the environmental history of water quality in Tampa Bay. Degraded conditions were common early in the period of record, particularly for Old Tampa Bay and Hillsborough Bay. Conditions began to improve by the late 1980s and early 1990s, with good conditions persisting to present day. However, recent trends in Old Tampa Bay have shown conditions changing from “stay the course” to “caution”.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Poe05">
<p>[1] A. Poe, K. Hackett, S. Janicki, R. Pribble, A. Janicki, Estimates of total nitrogen, total phosphorus, total suspended solids, and biochemical oxygen demand loadings to Tampa Bay, Florida: 1999-2003, Tampa Bay Estuary Program, St. Petersburg, Florida, USA, 2005. <a href="https://tbeptech.org/TBEP_TECH_PUBS/2005/TBEP_02_05Loadings99_03.pdf">https://tbeptech.org/TBEP_TECH_PUBS/2005/TBEP_02_05Loadings99_03.pdf</a>.</p>
</div>
<div id="ref-Greening06">
<p>[2] H. Greening, A. Janicki, Toward reversal of eutrophic conditions in a subtrophical estuary: Water quality and seagrass response to nitrogen loading reductions in Tampa Bay, Florida, USA, Environmental Management. 38 (2006) 163–178.</p>
</div>
<div id="ref-Tomasko05">
<p>[3] D.A. Tomasko, C.A. Corbett, H.S. Greening, G.E. Raulerson, Spatial and temporal variation in seagrass coverage in Southwest Florida: Assessing the relative effects of anthropogenic nutrient load reductions and rainfall in four contiguous estuaries, Marine Pollution Bulletin. 50 (2005) 797–805.</p>
</div>
<div id="ref-Santos80">
<p>[4] S.L. Santos, J.L. Simon, Marine soft-bottom community establishment following annual defaunation: Larval or adult recruitment, Marine Ecology - Progress Series. 2 (1980) 235–241.</p>
</div>
<div id="ref-Beck15">
<p>[5] M.W. Beck, J.D. Hagy III, Adaptation of a weighted regression approach to evaluate water quality trends in an estuary, Environmental Modelling and Assessment. 20 (2015) 637–655. <a href="https://doi.org/10.1007/s10666-015-9452-8">https://doi.org/10.1007/s10666-015-9452-8</a>.</p>
</div>
<div id="ref-Sherwood16">
<p>[6] E.T. Sherwood, H.S. Greening, A.J. Janicki, D.J. Karlen, Tampa Bay estuary: Monitoring long-term recovery through regional partnerships, Regional Studies in Marine Science. 4 (2016) 1–11. <a href="https://doi.org/10.1016/j.rsma.2015.05.005">https://doi.org/10.1016/j.rsma.2015.05.005</a>.</p>
</div>
<div id="ref-TBEP17">
<p>[7] TBEP (Tampa Bay Estuary Program), Tampa Bay Water Atlas, (2017).</p>
</div>
<div id="ref-Janicki99">
<p>[8] A. Janicki, D. Wade, J.R. Pribble, Development of a process to track the status of chlorophyll and light attenuation to support seagrass restoration goals in Tampa Bay, Tampa Bay National Estuary Program, St. Petersburg, Florida, 1999. <a href="https://tbeptech.org/TBEP_TECH_PUBS/2000/TBEP_04_00Chlor-A.pdf">https://tbeptech.org/TBEP_TECH_PUBS/2000/TBEP_04_00Chlor-A.pdf</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#package-goal">Package goal</a></li>
      <li><a href="#installing-tbeptools">Installing tbeptools</a></li>
      <li><a href="#read-1">Read</a></li>
      <li><a href="#analyze-1">Analyze</a></li>
      <li><a href="#show-1">Show</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marcus Beck, Ben Best.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
